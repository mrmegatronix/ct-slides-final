<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coasters Tavern Digital Signage</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Inter:wght@300;400;600&family=Roboto:wght@700&display=swap"
        rel="stylesheet">

    <!-- React & ReactDOM (UMD for standalone) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000;
            color: white;
            overflow: hidden;
        }

        h1,
        h2,
        h3,
        .serif {
            font-family: 'Playfair Display', serif;
        }

        /* --- Animations --- */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes spin-slow {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        @keyframes shimmer {
            100% {
                transform: translateX(100%) skewX(12deg);
            }
        }

        @keyframes subtleZoom {
            0% {
                transform: scale(1);
            }

            100% {
                transform: scale(1.15);
            }
        }

        @keyframes rain {
            0% {
                transform: translateY(0);
                opacity: 0;
            }

            20% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(60px);
                opacity: 0;
            }
        }

        @keyframes pulse-glow {

            0%,
            100% {
                box-shadow: 0 0 40px rgba(245, 158, 11, 0.4);
            }

            50% {
                box-shadow: 0 0 70px rgba(245, 158, 11, 0.8);
            }
        }

        /* Flame flickering animations */
        @keyframes flicker {

            0%,
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }

            10% {
                opacity: 0.85;
                transform: scale(1.02) translateY(-1px);
            }

            20% {
                opacity: 0.95;
                transform: scale(0.98) translateY(1px);
            }

            30% {
                opacity: 0.9;
                transform: scale(1.01) translateY(-2px);
            }

            40% {
                opacity: 1;
                transform: scale(0.99) translateY(0);
            }

            50% {
                opacity: 0.88;
                transform: scale(1.03) translateY(-1px);
            }

            60% {
                opacity: 0.95;
                transform: scale(0.97) translateY(1px);
            }

            70% {
                opacity: 0.92;
                transform: scale(1.02) translateY(-1px);
            }

            80% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }

            90% {
                opacity: 0.87;
                transform: scale(1.01) translateY(-1px);
            }
        }

        @keyframes flame-glow {

            0%,
            100% {
                box-shadow: 0 0 30px 10px rgba(255, 150, 50, 0.6), 0 0 60px 20px rgba(255, 100, 0, 0.4), 0 0 100px 40px rgba(255, 50, 0, 0.2);
            }

            25% {
                box-shadow: 0 0 35px 15px rgba(255, 160, 60, 0.7), 0 0 70px 25px rgba(255, 110, 10, 0.45), 0 0 110px 45px rgba(255, 60, 10, 0.25);
            }

            50% {
                box-shadow: 0 0 25px 8px rgba(255, 140, 40, 0.55), 0 0 55px 18px rgba(255, 90, 0, 0.35), 0 0 90px 35px rgba(255, 40, 0, 0.18);
            }

            75% {
                box-shadow: 0 0 40px 12px rgba(255, 155, 55, 0.65), 0 0 65px 22px rgba(255, 105, 5, 0.42), 0 0 105px 42px rgba(255, 55, 5, 0.22);
            }
        }

        @keyframes logo-pulse {

            0%,
            100% {
                transform: scale(1);
                filter: brightness(1);
            }

            50% {
                transform: scale(1.02);
                filter: brightness(1.1);
            }
        }

        .flame-effect {
            animation: flicker 0.15s ease-in-out infinite;
        }

        .flame-glow-effect {
            animation: flame-glow 2s ease-in-out infinite;
        }

        .logo-pulse {
            animation: logo-pulse 4s ease-in-out infinite;
        }

        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        .animate-spin-slow {
            animation: spin-slow 12s linear infinite;
        }

        .animate-shimmer {
            animation: shimmer 2s infinite;
        }

        .animate-rain {
            animation: rain 1.5s ease-in infinite;
        }

        .text-glow {
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.4);
        }

        .box-glow {
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.2), inset 0 0 20px rgba(255, 255, 255, 0.1);
        }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0"
  }
}
</script>
    <link rel="stylesheet" href="/index.css">
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback, useMemo } = React;

        // --- CONSTANTS & TYPES ---
        const SLIDE_DURATION_MS = 30000;
        const STORAGE_KEY = 'restaurant_slides_v1';

        const INITIAL_SLIDES = [
            { id: '0', day: 'Welcome', title: '', description: '', price: '', imageUrl: 'images/final-logo.png', highlightColor: '#d4af37', type: 'promo' },
            { id: '1', day: 'Monday', title: 'Steak Day Monday\'s', description: 'Start your week off with a 200g Succulent Rump Steak, cooked to your liking, served with golden fries, green garden salad and you\'re choice of sauce.', price: '$20', imageUrl: 'images/bg1.jpg', highlightColor: '#f59e0b', type: 'promo' },
            { id: '2', day: 'Tuesday', title: 'Chase the Ace', description: 'Tickets from 3.00pm. Simply purchase a beverage between 3.00pm and 5.30pm and you\'re in the draw.', price: '5.30pm', imageUrl: 'images/bg2.jpg', highlightColor: '#ef4444', type: 'promo' },
            { id: '3', day: 'Wednesday', title: 'Quiz Night', description: 'Starting back at 7pm on Wednesday, 21st January 2026, $190 in prizes up for grabs. Bookings Essential.', price: 'FREE ENTRY', imageUrl: 'images/bg3.jpg', highlightColor: '#eab308', type: 'promo' },
            { id: '4', day: 'Thursday', title: 'Burger Day Thursdays', description: 'Your choice of Chicken, Beer Battered Fish, Pork Belly or Coasters Beef Burger, all served with Golden Fries & Onion Rings.', price: '1 for $19 or 2 for $35!', imageUrl: 'images/bg4.jpg', highlightColor: '#f97316', type: 'promo' },
            { id: '5', day: 'Thursday & Friday', title: 'Happy Hours!!', description: 'Enjoy 10% discount on selected beverages between 4.30pm & 6.30pm, every Thursday & Friday', price: '10% Off!', imageUrl: 'images/fish-chips.jpg', highlightColor: '#3b82f6', type: 'promo' },
            { id: '6', day: 'Saturday', title: 'Chase the Ace', description: 'Tickets from 3.00pm. Simply purchase a beverage between 3.00pm and 6.30pm and you\'re in the draw.', price: '6.30pm', imageUrl: 'images/platter.jpg', highlightColor: '#06b6d4', type: 'promo' },
            { id: '7', day: 'Sunday', title: 'Two Course Sunday Roast', description: 'Traditional roast of the day with roasted vegetables, seasonal greens and rich gravy, with an Ice Cream Sundae to finish.', price: '$28', imageUrl: 'images/roast.jpg', highlightColor: '#84cc16', type: 'promo' },
            { id: '9', day: 'Thursday', title: 'Free Pool Thursdays', description: 'Our Pool Table is Free all day and night on Thursdays! Grab a cue and challenge your mates.', price: 'FREE!', imageUrl: 'images/burger-night.jpg', highlightColor: '#f97316', type: 'promo' },
            { id: '10', day: 'Membership', title: 'Loyalty App', description: 'Join our loyalty program! Earn points with every purchase and redeem them for food and drinks.', price: 'FREE!', imageUrl: 'images/platter.jpg', highlightColor: '#8b5cf6', type: 'promo' }
        ];

        // --- ICONS (Inline SVGs) ---
        const Icon = ({ path, className }) => (
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{path}</svg>
        );

        const Icons = {
            Settings: (props) => <Icon {...props} path={<><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z" /><circle cx="12" cy="12" r="3" /></>} />,
            Play: (props) => <Icon {...props} path={<polygon points="5 3 19 12 5 21 5 3" />} />,
            Pause: (props) => <Icon {...props} path={<><rect x="6" y="4" width="4" height="16" /><rect x="14" y="4" width="4" height="16" /></>} />,
            SkipForward: (props) => <Icon {...props} path={<><polygon points="5 4 15 12 5 20 5 4" /><line x1="19" y1="5" x2="19" y2="19" /></>} />,
            SkipBack: (props) => <Icon {...props} path={<><polygon points="19 20 9 12 19 4 19 20" /><line x1="5" y1="19" x2="5" y2="5" /></>} />,
            Plus: (props) => <Icon {...props} path={<><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></>} />,
            Trash2: (props) => <Icon {...props} path={<><polyline points="3 6 5 6 21 6" /><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" /><line x1="10" y1="11" x2="10" y2="17" /><line x1="14" y1="11" x2="14" y2="17" /></>} />,
            Save: (props) => <Icon {...props} path={<><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" /><polyline points="17 21 17 13 7 13 7 21" /><polyline points="7 3 7 8 15 8" /></>} />,
            X: (props) => <Icon {...props} path={<><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></>} />,
            ArrowLeft: (props) => <Icon {...props} path={<><line x1="19" y1="12" x2="5" y2="12" /><polyline points="12 19 5 12 12 5" /></>} />,
            LayoutGrid: (props) => <Icon {...props} path={<><rect x="3" y="3" width="7" height="7" /><rect x="14" y="3" width="7" height="7" /><rect x="14" y="14" width="7" height="7" /><rect x="3" y="14" width="7" height="7" /></>} />,
            Image: (props) => <Icon {...props} path={<><rect x="3" y="3" width="18" height="18" rx="2" ry="2" /><circle cx="8.5" cy="8.5" r="1.5" /><polyline points="21 15 16 10 5 21" /></>} />
        };

        const AdminPanel = ({ slides, onSave, onClose }) => {
            const [localSlides, setLocalSlides] = useState(slides);
            const [hasChanges, setHasChanges] = useState(false);

            const handleUpdate = (id, updates) => {
                setLocalSlides(prev => prev.map(s => s.id === id ? { ...s, ...updates } : s));
                setHasChanges(true);
            };

            const handleCreate = () => {
                const newSlide = { id: Date.now().toString(), type: 'promo', day: 'Monday', title: 'New Event', description: 'Details...', price: '$0', imageUrl: 'images/steak-night.jpg', highlightColor: '#f59e0b' };
                setLocalSlides([...localSlides, newSlide]);
                setHasChanges(true);
            };

            const handleDelete = (id) => {
                if (confirm('Delete this slide?')) {
                    setLocalSlides(prev => prev.filter(s => s.id !== id));
                    setHasChanges(true);
                }
            };

            return (
                <div className="fixed inset-0 z-50 bg-slate-950 text-white flex flex-col overflow-hidden">
                    <div className="bg-slate-900 border-b border-slate-800 p-6 flex justify-between items-center">
                        <div className="flex items-center gap-6">
                            <button onClick={onClose} className="p-2 hover:bg-slate-800 rounded-full transition-colors"><Icons.ArrowLeft className="w-6 h-6" /></button>
                            <h1 className="text-3xl font-serif font-bold text-amber-500 flex items-center gap-3"><Icons.LayoutGrid className="w-8 h-8" /> Tavern Overview</h1>
                        </div>
                        <div className="flex items-center gap-4">
                            <button onClick={handleCreate} className="bg-slate-800 hover:bg-slate-700 text-white px-5 py-2.5 rounded-lg font-bold border border-slate-700 flex items-center gap-2"><Icons.Plus className="w-5 h-5" /> Add Slide</button>
                            <button onClick={() => { onSave(localSlides); setHasChanges(false); }} disabled={!hasChanges} className={`px-8 py-2.5 rounded-lg font-bold transition-all flex items-center gap-2 ${hasChanges ? 'bg-amber-600 hover:bg-amber-500 text-white' : 'bg-slate-800 text-slate-500 cursor-not-allowed'}`}><Icons.Save className="w-5 h-5" /> {hasChanges ? 'Save Changes' : 'Saved'}</button>
                            <button onClick={onClose} className="p-2 hover:bg-red-500/20 text-slate-400 hover:text-red-400 rounded-full"><Icons.X className="w-6 h-6" /></button>
                        </div>
                    </div>
                    <div className="flex-1 overflow-y-auto p-8 bg-[radial-gradient(circle_at_top,_var(--tw-gradient-stops))] from-slate-900 to-slate-950">
                        <div className="max-w-[1600px] mx-auto grid grid-cols-1 xl:grid-cols-2 2xl:grid-cols-3 gap-6 pb-20">
                            {localSlides.filter(s => s.type === 'promo').map((slide, idx) => (
                                <div key={slide.id} className="bg-slate-900/50 border border-slate-800 rounded-2xl overflow-hidden flex flex-col p-6 space-y-4 hover:border-amber-500/30 transition-all">
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-[10px] font-black uppercase tracking-[0.3em] text-slate-500">Slide #{idx + 1}</span>
                                        <button onClick={() => handleDelete(slide.id)} className="p-2 text-slate-600 hover:text-red-400 hover:bg-red-400/10 rounded-lg"><Icons.Trash2 className="w-4 h-4" /></button>
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Day</label><input type="text" value={slide.day} onChange={e => handleUpdate(slide.id, { day: e.target.value })} className="w-full bg-slate-950/50 border border-slate-700 rounded-lg p-2 text-sm outline-none focus:border-amber-500" /></div>
                                        <div className="space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Price</label><input type="text" value={slide.price} onChange={e => handleUpdate(slide.id, { price: e.target.value })} className="w-full bg-slate-950/50 border border-slate-700 rounded-lg p-2 text-sm outline-none focus:border-amber-500 font-bold text-amber-500" /></div>
                                    </div>
                                    <div className="space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Title</label><input type="text" value={slide.title} onChange={e => handleUpdate(slide.id, { title: e.target.value })} className="w-full bg-slate-950/50 border border-slate-700 rounded-lg p-2 text-sm font-bold outline-none focus:border-amber-500" /></div>
                                    <div className="space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Description</label><textarea value={slide.description} onChange={e => handleUpdate(slide.id, { description: e.target.value })} rows={3} className="w-full bg-slate-950/50 border border-slate-700 rounded-lg p-2 text-sm outline-none focus:border-amber-500 resize-none" /></div>
                                    <div className="flex items-center gap-4">
                                        <div className="flex-1 space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Image Path</label><input type="text" value={slide.imageUrl} onChange={e => handleUpdate(slide.id, { imageUrl: e.target.value })} className="w-full bg-slate-950/50 border border-slate-700 rounded-lg p-2 text-xs font-mono outline-none focus:border-amber-500" /></div>
                                        <div className="shrink-0 space-y-1"><label className="text-[10px] font-bold text-slate-500 uppercase">Color</label><input type="color" value={slide.highlightColor} onChange={e => handleUpdate(slide.id, { highlightColor: e.target.value })} className="h-9 w-9 bg-transparent block cursor-pointer border border-slate-700 rounded-lg" /></div>
                                    </div>
                                </div>
                            ))}
                            <button onClick={handleCreate} className="border-2 border-dashed border-slate-800 rounded-2xl flex flex-col items-center justify-center p-12 text-slate-600 hover:text-amber-500 hover:border-amber-500/50 transition-all"><Icons.Plus className="w-10 h-10 mb-2" /><span className="font-bold uppercase tracking-widest text-xs">Add New Promo</span></button>
                        </div>
                    </div>
                </div>
            );
        };

        // Welcome slide with centered logo and flickering flame effect
        const WelcomeSlide = () => {
            return (
                <div className="relative w-full h-full overflow-hidden bg-black flex items-center justify-center">
                    {/* Ambient glow behind logo */}
                    <div className="absolute w-[600px] h-[600px] rounded-full bg-gradient-radial from-amber-900/20 via-transparent to-transparent" style={{ filter: 'blur(60px)' }}></div>

                    {/* Logo container */}
                    <div className="relative">
                        {/* Logo image */}
                        <img
                            src="images/final-logo-transparent.png"
                            alt="Coasters Tavern"
                            className="w-[75%] h-auto logo-pulse drop-shadow-[0_0_30px_rgba(212,175,55,0.3)]"
                        />

                        {/* Flame glow overlay - positioned over the lantern area */}
                        <div
                            className="absolute flame-glow-effect"
                            style={{
                                width: '60px',
                                height: '80px',
                                left: '50%',
                                top: '42%',
                                transform: 'translateX(-50%)',
                                borderRadius: '50% 50% 50% 50% / 60% 60% 40% 40%',
                                background: 'radial-gradient(ellipse at center, rgba(255, 200, 100, 0.0) 0%, rgba(255, 150, 50, 0.0) 40%, transparent 70%)',
                                pointerEvents: 'none'
                            }}
                        ></div>

                        {/* Inner flame flicker effect */}
                        <div
                            className="absolute flame-effect"
                            style={{
                                width: '30px',
                                height: '40px',
                                left: '50%',
                                top: '44%',
                                transform: 'translateX(-50%)',
                                borderRadius: '50% 50% 50% 50% / 60% 60% 40% 40%',
                                background: 'radial-gradient(ellipse at center, rgba(255, 220, 150, 0.0) 0%, rgba(255, 180, 80, 0.0) 50%, transparent 100%)',
                                pointerEvents: 'none'
                            }}
                        ></div>

                        {/* Ambient light particles */}
                        <div className="absolute w-4 h-4 rounded-full bg-amber-400/40 blur-sm" style={{ left: '48%', top: '40%', animation: 'flicker 0.2s ease-in-out infinite' }}></div>
                        <div className="absolute w-2 h-2 rounded-full bg-orange-300/50 blur-sm" style={{ left: '51%', top: '43%', animation: 'flicker 0.15s ease-in-out infinite 0.05s' }}></div>
                        <div className="absolute w-3 h-3 rounded-full bg-yellow-400/30 blur-sm" style={{ left: '49%', top: '38%', animation: 'flicker 0.18s ease-in-out infinite 0.1s' }}></div>
                    </div>
                </div>
            );
        };

        const Slide = ({ data }) => {
            return (
                <div className="relative w-full h-full overflow-hidden font-sans">
                    <div className="absolute inset-0">
                        <img src={data.imageUrl} alt={data.title} onError={(e) => { e.currentTarget.style.display = 'none'; }} className="w-full h-full object-cover" style={{ animation: 'subtleZoom 35s linear infinite alternate' }} />
                        <div className="absolute inset-0 bg-black/60"></div>
                        <div className="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-black/60"></div>
                    </div>
                    <div className="relative z-10 w-full h-full flex flex-col justify-center items-center p-8 md:p-16 max-w-[90%] mx-auto text-center space-y-12">
                        <div className="animate-slide-down"><span className="px-10 py-4 rounded-full text-4xl font-black uppercase tracking-[0.2em] border-2 border-white/40 backdrop-blur-xl shadow-[0_0_30px_rgba(255,255,255,0.3)]" style={{ backgroundColor: `${data.highlightColor}40`, borderColor: data.highlightColor, color: '#fff' }}>{data.day || 'Special Event'}</span></div>
                        <div className="flex flex-col items-center space-y-8 animate-fade-in-up">
                            <h1 className="text-6xl md:text-8xl font-serif font-black leading-none text-white drop-shadow-[0_5px_15px_rgba(0,0,0,0.8)] text-glow tracking-wide">{data.title}</h1>
                            <div className="h-2 w-48 rounded-full" style={{ backgroundColor: data.highlightColor || '#f59e0b' }}></div>
                            <p className="text-4xl md:text-5xl text-gray-100 font-bold leading-relaxed max-w-7xl drop-shadow-lg opacity-90">{data.description}</p>
                            {data.price && (
                                <div className="mt-12 animate-pop-in">
                                    <div className="relative group rounded-3xl p-[3px] bg-gradient-to-br from-white/80 to-amber-500/50 overflow-hidden" style={{ animation: 'pulse-glow 3s infinite', boxShadow: `0 0 60px ${data.highlightColor || '#f59e0b'}80` }}>
                                        <div className="absolute inset-0 bg-white/20 blur-xl"></div>
                                        <div className="relative px-16 py-8 rounded-[21px] backdrop-blur-xl bg-black/50 border border-white/30 flex flex-col items-center justify-center">
                                            <span className="text-6xl md:text-7xl font-black text-white">{data.price}</span>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // Weather code to condition mapping for Open-Meteo API
        const getWeatherCondition = (code) => {
            if (code === 0) return { condition: 'sunny', label: 'Clear Sky' };
            if (code >= 1 && code <= 3) return { condition: 'partly-cloudy', label: 'Partly Cloudy' };
            if (code >= 45 && code <= 48) return { condition: 'cloudy', label: 'Foggy' };
            if (code >= 51 && code <= 67) return { condition: 'rain', label: 'Rainy' };
            if (code >= 71 && code <= 77) return { condition: 'snow', label: 'Snowy' };
            if (code >= 80 && code <= 82) return { condition: 'rain', label: 'Showers' };
            if (code >= 95 && code <= 99) return { condition: 'thunderstorm', label: 'Thunderstorm' };
            return { condition: 'cloudy', label: 'Cloudy' };
        };

        // Animated Weather Icon Component
        const AnimatedWeatherIcon = ({ condition, size = "large" }) => {
            const sizeClasses = size === "large" ? "w-48 h-48 text-8xl" : "w-16 h-16 text-4xl";

            switch (condition) {
                case 'rain':
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center`}>
                            <div className="absolute animate-float">‚òÅÔ∏è</div>
                            <div className="absolute top-1/2 left-1/2 -ml-2 animate-rain text-blue-400 text-sm">üíß</div>
                            <div className="absolute top-1/2 left-1/2 ml-2 animate-rain text-blue-400 text-sm" style={{ animationDelay: '0.5s' }}>üíß</div>
                            <div className="absolute top-1/2 left-1/2 animate-rain text-blue-400 text-sm" style={{ animationDelay: '0.2s' }}>üíß</div>
                        </div>
                    );
                case 'cloudy':
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center text-gray-400`}>
                            <div className="absolute animate-float" style={{ animationDuration: '8s' }}>‚òÅÔ∏è</div>
                            <div className="absolute animate-float opacity-70 top-2 -right-2" style={{ animationDuration: '6s', animationDelay: '1s' }}>‚òÅÔ∏è</div>
                        </div>
                    );
                case 'partly-cloudy':
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center`}>
                            <div className="absolute animate-spin-slow text-yellow-400 opacity-80" style={{ fontSize: '0.8em' }}>‚òÄÔ∏è</div>
                            <div className="absolute animate-float text-white/90 top-1 -right-2">‚òÅÔ∏è</div>
                        </div>
                    );
                case 'snow':
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center`}>
                            <div className="absolute animate-float text-gray-300">‚òÅÔ∏è</div>
                            <div className="absolute top-1/2 animate-rain text-white text-xs">‚ùÑÔ∏è</div>
                            <div className="absolute top-1/2 left-1/3 animate-rain text-white text-xs" style={{ animationDelay: '0.7s' }}>‚ùÑÔ∏è</div>
                        </div>
                    );
                case 'thunderstorm':
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center`}>
                            <div className="absolute animate-float text-slate-500">‚òÅÔ∏è</div>
                            <div className="absolute top-1/2 text-yellow-400 animate-pulse text-2xl">‚ö°</div>
                        </div>
                    );
                default: // sunny
                    return (
                        <div className={`relative ${sizeClasses} flex items-center justify-center`}>
                            <div className="absolute animate-spin-slow text-yellow-400">‚òÄÔ∏è</div>
                        </div>
                    );
            }
        };

        const WeatherView = () => {
            const [current, setCurrent] = useState({ temp: '--', condition: 'sunny', label: 'Loading...' });
            const [forecast, setForecast] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const fetchWeather = async () => {
                    try {
                        const lat = -43.5321;
                        const lon = 172.6362;
                        const response = await fetch(
                            `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=Pacific%2FAuckland`
                        );
                        const data = await response.json();

                        // Current Weather
                        if (data.current) {
                            setCurrent({
                                temp: Math.round(data.current.temperature_2m),
                                ...getWeatherCondition(data.current.weather_code)
                            });
                        }

                        // 7-Day Forecast
                        if (data.daily) {
                            const dailyData = data.daily.time.map((time, index) => ({
                                day: new Date(time).toLocaleDateString('en-NZ', { weekday: 'short' }),
                                max: Math.round(data.daily.temperature_2m_max[index]),
                                min: Math.round(data.daily.temperature_2m_min[index]),
                                ...getWeatherCondition(data.daily.weather_code[index])
                            }));
                            setForecast(dailyData);
                        }

                    } catch (error) {
                        console.error('Weather fetch error:', error);
                        setCurrent({ temp: '--', condition: 'cloudy', label: 'Unavailable' });
                    } finally {
                        setLoading(false);
                    }
                };
                fetchWeather();
                const interval = setInterval(fetchWeather, 600000);
                return () => clearInterval(interval);
            }, []);

            return (
                <div className="w-full h-full bg-slate-950 flex flex-col p-12">
                    {/* Header Section: Current Weather */}
                    <div className="flex-1 flex flex-col items-center justify-center mb-8 relative">
                        <h2 className="text-xl text-blue-200/60 uppercase tracking-[0.3em] mb-2 absolute top-0">Live Weather</h2>
                        <h1 className="text-6xl font-serif font-bold mb-4">Christchurch</h1>

                        <div className="flex items-center gap-12 bg-white/5 px-20 py-10 rounded-[3rem] border border-white/10 backdrop-blur-xl shadow-2xl">
                            <AnimatedWeatherIcon condition={current.condition} size="large" />
                            <div className="flex flex-col items-start min-w-[200px]">
                                <span className="text-9xl font-black leading-none bg-gradient-to-br from-white to-gray-400 bg-clip-text text-transparent">{current.temp}¬∞</span>
                                <span className="text-3xl text-blue-200/80 font-medium mt-2">{current.label}</span>
                            </div>
                        </div>
                    </div>

                    {/* Footer Section: 7-Day Forecast */}
                    <div className="h-48 w-full mt-8">
                        <div className="grid grid-cols-7 gap-4 h-full">
                            {forecast.slice(0, 7).map((day, idx) => (
                                <div key={idx} className="bg-white/5 border border-white/5 rounded-2xl flex flex-col items-center justify-center p-2 backdrop-blur-md hover:bg-white/10 transition-colors">
                                    <span className="text-xl font-bold uppercase tracking-widest text-blue-200/60 mb-2">{idx === 0 ? 'Today' : day.day}</span>
                                    <div className="mb-2 scale-90">
                                        <AnimatedWeatherIcon condition={day.condition} size="small" />
                                    </div>
                                    <div className="flex gap-3 text-2xl font-bold">
                                        <span className="text-white">{day.max}¬∞</span>
                                        <span className="text-white/40">{day.min}¬∞</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [slides, setSlides] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [isPlaying, setIsPlaying] = useState(true);
            const [isAdminOpen, setIsAdminOpen] = useState(false);
            const [progress, setProgress] = useState(0);

            useEffect(() => {
                const saved = localStorage.getItem(STORAGE_KEY);
                setSlides(saved ? JSON.parse(saved) : INITIAL_SLIDES);
            }, []);

            const playlist = useMemo(() => [...slides, { id: 'weather', type: 'weather' }], [slides]);
            const currentSlide = playlist[currentIndex];

            const nextSlide = useCallback(() => { setCurrentIndex(prev => (prev + 1) % playlist.length); setProgress(0); }, [playlist.length]);
            const prevSlide = useCallback(() => { setCurrentIndex(prev => (prev - 1 + playlist.length) % playlist.length); setProgress(0); }, [playlist.length]);

            useEffect(() => {
                if (!isPlaying || isAdminOpen) return;
                const interval = setInterval(() => {
                    setProgress(prev => {
                        if (prev >= 100) { nextSlide(); return 0; }
                        return prev + (100 / (SLIDE_DURATION_MS / 100));
                    });
                }, 100);
                return () => clearInterval(interval);
            }, [isPlaying, isAdminOpen, nextSlide]);

            if (!currentSlide) return null;

            return (
                <div className="relative w-screen h-screen bg-black overflow-hidden group">
                    {currentSlide.type === 'weather' ? <WeatherView /> :
                        currentSlide.day === 'Welcome' ? <WelcomeSlide /> :
                            <Slide key={currentSlide.id} data={currentSlide} />}
                    <div className="absolute bottom-0 left-0 w-full h-4 bg-black/60 z-40">
                        <div className="h-full bg-gradient-to-r from-amber-600 to-yellow-400 transition-all duration-100 ease-linear" style={{ width: `${progress}%` }}></div>
                    </div>
                    <div className="absolute top-8 right-8 z-50 opacity-0 group-hover:opacity-100 transition-opacity flex gap-3">
                        <button onClick={prevSlide} className="p-4 bg-white/10 hover:bg-amber-600 rounded-full transition-colors" title="Previous"><Icons.SkipBack className="w-6 h-6" /></button>
                        <button onClick={() => setIsPlaying(!isPlaying)} className="p-4 bg-white/10 hover:bg-amber-600 rounded-full transition-colors" title={isPlaying ? 'Pause' : 'Play'}>{isPlaying ? <Icons.Pause className="w-6 h-6" /> : <Icons.Play className="w-6 h-6" />}</button>
                        <button onClick={nextSlide} className="p-4 bg-white/10 hover:bg-amber-600 rounded-full transition-colors" title="Next"><Icons.SkipForward className="w-6 h-6" /></button>
                        <div className="w-px bg-white/20 mx-1"></div>
                        <button onClick={() => setIsAdminOpen(true)} className="p-4 bg-white/10 hover:bg-blue-600 rounded-full transition-colors" title="Settings"><Icons.Settings className="w-6 h-6" /></button>
                    </div>
                    {isAdminOpen && <AdminPanel slides={slides} onSave={(s) => { setSlides(s); localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }} onClose={() => setIsAdminOpen(false)} />}
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
    <script type="module" src="/index.tsx"></script>
</body>

</html>